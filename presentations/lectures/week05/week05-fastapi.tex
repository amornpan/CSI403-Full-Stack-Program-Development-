% ============================================
% Week 5: FastAPI Introduction
% CSI403 Full Stack Development
% Date: February 4-6, 2026
% ============================================

\input{../../common/preamble}

\title[Week 5: FastAPI]{Week 5: FastAPI Web Framework}
\subtitle{CSI403 Full Stack Development}
\date{February 4-6, 2026}

\begin{document}

\begin{frame}[plain]
    \titlepage
\end{frame}

\begin{frame}{Today's Agenda}
    \tableofcontents
\end{frame}

% ============================================
\section{Introduction to FastAPI}
% ============================================

\begin{frame}{What is FastAPI?}
    \weekheader{5}{Feb 4-6}
    
    \begin{block}{FastAPI}
        A modern, fast (high-performance), web framework for building APIs with Python 3.7+ based on standard Python type hints.
    \end{block}
    
    \vspace{0.3cm}
    
    \textbf{Key Features:}
    \begin{itemize}
        \item \textbf{Fast} - Very high performance, on par with NodeJS and Go
        \item \textbf{Easy} - Designed to be easy to use and learn
        \item \textbf{Automatic Docs} - Interactive API documentation (Swagger UI)
        \item \textbf{Type Hints} - Built on Python type hints for validation
        \item \textbf{Standards} - Based on OpenAPI and JSON Schema
    \end{itemize}
\end{frame}

\begin{frame}{FastAPI vs Other Frameworks}
    \begin{center}
        \begin{tabular}{|l|c|c|c|}
            \hline
            \textbf{Feature} & \textbf{FastAPI} & \textbf{Flask} & \textbf{Django} \\
            \hline
            Performance & \textcolor{codegreen}{High} & Medium & Medium \\
            Async Support & \textcolor{codegreen}{Yes} & Limited & Limited \\
            Auto Documentation & \textcolor{codegreen}{Yes} & No & No \\
            Type Validation & \textcolor{codegreen}{Built-in} & Manual & Manual \\
            Learning Curve & Easy & Easy & Steep \\
            Best For & APIs & Simple Apps & Full Apps \\
            \hline
        \end{tabular}
    \end{center}
    
    \begin{infobox}[Why FastAPI for This Course?]
        Perfect balance of simplicity and power. Great for learning modern API development with automatic validation and documentation.
    \end{infobox}
\end{frame}

\begin{frame}{Installation \& First App}
    \begin{codebox}[Installation]
        \begin{lstlisting}[style=bash]
pip install fastapi uvicorn[standard]
        \end{lstlisting}
    \end{codebox}
    
    \begin{codebox}[main.py - Hello World]
        \begin{lstlisting}[style=python]
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def read_root():
    return {"message": "Hello, World!"}

@app.get("/loans")
def get_loans():
    return {"loans": []}
        \end{lstlisting}
    \end{codebox}
    
    \begin{codebox}[Run Server]
        \begin{lstlisting}[style=bash]
uvicorn main:app --reload
# Server running at http://127.0.0.1:8000
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Routes \& HTTP Methods}
% ============================================

\begin{frame}{HTTP Methods Overview}
    \begin{center}
        \begin{tabular}{|l|l|l|}
            \hline
            \textbf{Method} & \textbf{Purpose} & \textbf{Example} \\
            \hline
            GET & Read/Retrieve data & Get all loans \\
            POST & Create new data & Create new loan \\
            PUT & Update (replace) data & Update loan info \\
            PATCH & Partial update & Update loan status \\
            DELETE & Remove data & Delete a loan \\
            \hline
        \end{tabular}
    \end{center}
    
    \begin{codebox}[Route Decorators]
        \begin{lstlisting}[style=python]
@app.get("/loans")          # GET - Read
@app.post("/loans")         # POST - Create
@app.put("/loans/{id}")     # PUT - Update
@app.patch("/loans/{id}")   # PATCH - Partial Update
@app.delete("/loans/{id}")  # DELETE - Remove
        \end{lstlisting}
    \end{codebox}
\end{frame}

\begin{frame}{CRUD Operations Example}
    \begin{codebox}[Complete CRUD]
        \begin{lstlisting}[style=python,basicstyle=\ttfamily\tiny]
from fastapi import FastAPI, HTTPException

app = FastAPI()
loans_db = []  # Simple in-memory database

@app.get("/loans")
def get_all_loans():
    return {"loans": loans_db}

@app.get("/loans/{loan_id}")
def get_loan(loan_id: int):
    for loan in loans_db:
        if loan["id"] == loan_id:
            return loan
    raise HTTPException(status_code=404, detail="Loan not found")

@app.post("/loans")
def create_loan(amount: float, term: int):
    loan = {"id": len(loans_db) + 1, "amount": amount, "term": term}
    loans_db.append(loan)
    return loan

@app.delete("/loans/{loan_id}")
def delete_loan(loan_id: int):
    for i, loan in enumerate(loans_db):
        if loan["id"] == loan_id:
            return loans_db.pop(i)
    raise HTTPException(status_code=404, detail="Loan not found")
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Path \& Query Parameters}
% ============================================

\begin{frame}{Path Parameters}
    \begin{codebox}[Path Parameters]
        \begin{lstlisting}[style=python]
# Single path parameter
@app.get("/loans/{loan_id}")
def get_loan(loan_id: int):
    return {"loan_id": loan_id}

# Multiple path parameters
@app.get("/users/{user_id}/loans/{loan_id}")
def get_user_loan(user_id: int, loan_id: int):
    return {"user_id": user_id, "loan_id": loan_id}

# Path with validation
from fastapi import Path

@app.get("/loans/{loan_id}")
def get_loan(
    loan_id: int = Path(..., gt=0, description="Loan ID must be positive")
):
    return {"loan_id": loan_id}
        \end{lstlisting}
    \end{codebox}
\end{frame}

\begin{frame}{Query Parameters}
    \begin{codebox}[Query Parameters]
        \begin{lstlisting}[style=python]
from typing import Optional

# Basic query parameters
# URL: /loans?skip=0&limit=10
@app.get("/loans")
def get_loans(skip: int = 0, limit: int = 10):
    return {"skip": skip, "limit": limit}

# Optional query parameter
# URL: /loans?status=current
@app.get("/loans")
def get_loans(status: Optional[str] = None):
    if status:
        return {"filter": status}
    return {"loans": "all"}

# Multiple filters
# URL: /loans?status=current&min_amount=10000
@app.get("/loans")
def get_loans(
    status: Optional[str] = None,
    min_amount: Optional[float] = None,
    max_amount: Optional[float] = None
):
    return {"status": status, "min": min_amount, "max": max_amount}
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Request Body \& Pydantic}
% ============================================

\begin{frame}{Pydantic Models}
    \begin{codebox}[schemas.py]
        \begin{lstlisting}[style=python]
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

class LoanCreate(BaseModel):
    amount: float = Field(..., gt=0, le=1000000)
    term: int = Field(..., description="Months: 12, 24, 36, 48, 60")
    purpose: Optional[str] = None
    
    class Config:
        json_schema_extra = {
            "example": {
                "amount": 100000,
                "term": 36,
                "purpose": "Home improvement"
            }
        }

class LoanResponse(BaseModel):
    id: int
    amount: float
    term: int
    status: str = "pending"
    created_at: datetime
        \end{lstlisting}
    \end{codebox}
\end{frame}

\begin{frame}{Using Pydantic in Routes}
    \begin{codebox}[Request Body Validation]
        \begin{lstlisting}[style=python]
from fastapi import FastAPI
from schemas import LoanCreate, LoanResponse
from datetime import datetime

app = FastAPI()

@app.post("/loans", response_model=LoanResponse)
def create_loan(loan: LoanCreate):
    # loan is automatically validated!
    new_loan = {
        "id": 1,
        "amount": loan.amount,
        "term": loan.term,
        "status": "pending",
        "created_at": datetime.now()
    }
    return new_loan

# FastAPI will:
# 1. Validate request body against LoanCreate
# 2. Return 422 if validation fails
# 3. Validate response against LoanResponse
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Templates \& HTML Response}
% ============================================

\begin{frame}{Rendering Templates}
    \begin{codebox}[Setup Templates]
        \begin{lstlisting}[style=python]
from fastapi import FastAPI, Request
from fastapi.templating import Jinja2Templates
from fastapi.responses import HTMLResponse

app = FastAPI()
templates = Jinja2Templates(directory="templates")

@app.get("/", response_class=HTMLResponse)
def home(request: Request):
    return templates.TemplateResponse(
        "home.html",
        {"request": request, "title": "Home"}
    )

@app.get("/loans", response_class=HTMLResponse)
def loans_page(request: Request):
    loans = [
        {"id": 1, "amount": 100000, "status": "current"},
        {"id": 2, "amount": 50000, "status": "paid"}
    ]
    return templates.TemplateResponse(
        "loans.html",
        {"request": request, "loans": loans}
    )
        \end{lstlisting}
    \end{codebox}
\end{frame}

\begin{frame}{Static Files}
    \begin{codebox}[Serving Static Files]
        \begin{lstlisting}[style=python]
from fastapi import FastAPI
from fastapi.staticfiles import StaticFiles

app = FastAPI()

# Mount static directory
app.mount("/static", StaticFiles(directory="static"), name="static")

# Now files in /static folder are accessible:
# /static/css/style.css
# /static/js/main.js
# /static/images/logo.png
        \end{lstlisting}
    \end{codebox}
    
    \begin{codebox}[In Template]
        \begin{lstlisting}[style=html]
<link rel="stylesheet" href="/static/css/style.css">
<script src="/static/js/main.js"></script>
<img src="/static/images/logo.png">
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Swagger Documentation}
% ============================================

\begin{frame}{Automatic API Documentation}
    \begin{block}{Built-in Documentation}
        FastAPI automatically generates interactive API documentation!
    \end{block}
    
    \textbf{Available at:}
    \begin{itemize}
        \item \urlbox{http://127.0.0.1:8000/docs} - Swagger UI
        \item \urlbox{http://127.0.0.1:8000/redoc} - ReDoc
    \end{itemize}
    
    \vspace{0.3cm}
    
    \begin{codebox}[Customize API Info]
        \begin{lstlisting}[style=python]
app = FastAPI(
    title="Loan Management API",
    description="API for managing loans and payments",
    version="1.0.0",
    contact={
        "name": "CSI403 Team",
        "email": "support@example.com"
    }
)
        \end{lstlisting}
    \end{codebox}
\end{frame}

\begin{frame}{Adding Documentation to Routes}
    \begin{codebox}[Document Your Endpoints]
        \begin{lstlisting}[style=python,basicstyle=\ttfamily\tiny]
@app.get(
    "/loans",
    response_model=list[LoanResponse],
    summary="Get all loans",
    description="Retrieve a list of all loans with optional filtering",
    tags=["Loans"]
)
def get_loans(
    status: Optional[str] = Query(
        None, 
        description="Filter by status: pending, current, paid, default"
    ),
    skip: int = Query(0, ge=0, description="Number of records to skip"),
    limit: int = Query(10, ge=1, le=100, description="Max records to return")
):
    """
    Get all loans with pagination and filtering.
    
    - **status**: Filter loans by their current status
    - **skip**: Skip first N records (for pagination)
    - **limit**: Maximum number of records to return
    """
    return []
        \end{lstlisting}
    \end{codebox}
\end{frame}

% ============================================
\section{Lab Assignment}
% ============================================

\begin{frame}{Lab1\_Design Assignment}
    \begin{alertblock}{Due: This Week (5\%)}
        Create UI mockups and wireframes for the Loan Management System.
    \end{alertblock}
    
    \textbf{Requirements:}
    \begin{enumerate}
        \item Design at least 5 pages:
            \begin{itemize}
                \item Home page
                \item Login/Register
                \item Dashboard (Borrower)
                \item Loan List
                \item Loan Application Form
            \end{itemize}
        \item Use Figma, Adobe XD, or hand-drawn
        \item Include navigation flow
        \item Document in Notion
    \end{enumerate}
    
    \begin{infobox}[Submission]
        Add wireframes to your Notion workspace and link in GitHub README.
    \end{infobox}
\end{frame}

% ============================================
\section{Summary}
% ============================================

\begin{frame}{Week 5 Summary}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \begin{block}{What We Learned}
                \begin{itemize}
                    \item[$\checkmark$] FastAPI basics
                    \item[$\checkmark$] HTTP methods
                    \item[$\checkmark$] Path parameters
                    \item[$\checkmark$] Query parameters
                    \item[$\checkmark$] Pydantic validation
                    \item[$\checkmark$] Template rendering
                    \item[$\checkmark$] Swagger docs
                \end{itemize}
            \end{block}
        \end{column}
        \begin{column}{0.48\textwidth}
            \begin{alertblock}{Next Week}
                \textbf{Week 6: SQLAlchemy ORM}
                \begin{itemize}
                    \item Database models
                    \item Relationships
                    \item CRUD operations
                    \item Connecting to MSSQL
                \end{itemize}
            \end{alertblock}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}[plain]
    \begin{center}
        \vspace{2cm}
        {\Huge\bfseries\color{spumaroon} Questions?}
        \vspace{1cm}
        
        {\Large Thank you!}
        \vspace{1cm}
        
        \includegraphics[height=1cm]{spu_logo.png}
    \end{center}
\end{frame}

\end{document}
